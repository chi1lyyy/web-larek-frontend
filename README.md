# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Описание проекта
  "Веб-ларек" - это интернет-магазин, в котором пользователи могут оформить покупку товаров с доставкой на дом. Для получения данных о товарах и для передачи данных заказа использовано API.
  
  Интерфейс приложения содержит главную страницу, на которой отображается каталог товаров. При клике на карточку товара на главной странице открывается модальное окно с детальной информацией о товаре, реализованное компонентом **ProductModal**. На главной странице также присутствует иконка корзины с счетчиком товаров, добавленных туда. При клике на иконку корзины на главной странице открывается модальное окно со списком товаров, добавленных в корзину, реализованное компонентом ...(**CartModal**).

  При открытии модального окна с товаром (**ProductModal**) отображается детальная информация о товаре и появляется возможность добавить товар в корзину нажатием на кнопку "Купить". При добавлении товара в корзину модальное окно закрывается, обновляется счетчик товаров в корзине на главной странице. При открытии карточки товара, уже добавленного в корзину, кнопка "Купить" становится кнопкой "Удалить", при клике на которую товар удаляется из корзины, закрывается модальное окно и обновляется счетччик товаров в корзине на главной странице. 
  
  При открытии корзины (**CartModal**) отображается список товаров, добавленных в корзину. Когда товаров нет в корзине кнопка оформления заказа заблокирована. Когда товары в корзине есть товары, считается их общая стоимость, появляется возможность оформить заказ. 
  
  При нажатии на кнопку "Оформить" в корзине открывается модальное окно заказа (**OrderModal**), в котором можно выбрать способ оплаты и ввести адрес доставки. Поле ввода адреса валидируется: пока оно не заполнено невозможно продолжить оформление заказа (т.е. нажать на кнопку "далее"). При корректном заполнении данных кнопка "далее" разблокируется.
  
  При нажатии на кнопку "далее" в окне заказа открывается модальное окно ввода данных информации о покупателе (**ClientModal**). В этом окне необходимо заполнить поля ввода email и номера телефона. При корректном заполнении данных разблокируется кнопка "оплатить".
  
  При нажатии на кнопку оплаты в модальном окне ввода данных о покупателе открывается модальное окно успешного оформления заказа (**SuccessModal**), сообщающее пользователю об успешном оформлении заказа, корзина очищается.


## Компоненты
Архитектура проекта реализована моделью MVP, компоненты реализации проекта можно разделить на три слоя:
1. Слой данных. Отвечает за хранение даннымх в приложении. Состоит из классов **APIProduct**, **Cart**, **Order**.
 
2. Слой отображения. Отвечает за отображение данных. Включает в себя **Products**(?), **BaseModalWindow** (общая структура модальных окон), **ProductModal**, **CartModal**, **OrderModal**, **ClientModal**, **SuccessModal**
3. Слой взаимодействия. Отвечает за взаимодействие между слоями и логику приложения. Обрабатывает действия пользователя на странице и передает данные с помощью брокера событий **EventEmitter** и класса **App**.

### Слой данных
- Класс **APIService** наследует базовый класс Api, отвечающий за работу с API приложения. Получает данные о товарах с сервера и передает данные заказа на сервер. В конструкторе принимет базовый URL и настройки. Метод getProducts() возвращает список всех товаров, getProductItem(id) - конкретный товар по его id. Методом submitOrder(orderData) можно отправить данные заказа на сервер.

- Класс **Cart** хранит данные о корзине товаров. Имеет свойства items: IProduct[], total: number, в конструкторе инициализируется пустой массив добавленных в корзину товаров и общая (нулевая) сумма заказа. Методы:
  addItem(product). Добавляет товар в корзину. 
  removeItem(id). Удаляет товар из корзины.
  getItems(). Возвращает текущий список товаров в корзине.
  countTotal(). Считает общую сумму товаров в корзине. 
  clearCart(). Очищает корзину после отправки данных на сервер.
  countProducts(). Считает общее количество товаров в корзине (для счетчика) 

- **Order** собирает данные о заказе для передачи данных на сервер. Имплиментирует интерфейс **IOrder**. Содержит свойства интерфейса. В конструкторе инициализируется пустой заказ. Методы:
  setPayment, setEmail, setPhone, setAddress, setCartData - устанавливают данные заказа.
  validate() - проверяет корректность заполнения данных.

### Слой отображения

- **Products** отвечает за отображение каталога товаров.
  
- **ModalWindow** реализует общую логику открытия/закрытия модальных окон на странице.
  Имеет свойства:
  modalElement: HTMLElement | null: Корневой элемент модального окна в DOM.
  closeButton: HTMLElement | null: Кнопка "Закрыть" внутри модального окна.
  content: HTMLElement | null: Контейнер для контента.
  
  Конструктор принимает селектор модального окна и инициализирует свойства класса.
  ```typescript
  constructor(modalSelector: string) {
        this.modalElement = document.querySelector(modalSelector);
        this.closeButton = this.modalElement?.querySelector(".close-button") ;
        this.contentElement = this.modalElement?.querySelector(".modal__content") || null;
  }
Имеет методы 
open(), close(). Открывают/закрывают модальные окна, добавляя/удаляя класс '.modal_active'.
render(content). Вставляет в модальное окно переданный контент.
? handleClose(event). Обрабатывает клик на кнопку закрытия.
? addEventListeners(): void: Добавляет обработчики событий для кнопки "Закрыть".
? removeEventListeners(): void: Удаляет обработчики событий при закрытии модального окна.

- **ProductModal**. Имеет ?метод addToCart?, устанавливающий слушатель события нажатия на кнопку добавления товара в корзину. Метод render(updateButtonText) меняет текст на кнопке модального окна в зависимости от того, добавлен ли товар в корзину.

- **CartModal**. ... В классе устанавливается слушатель события нажатия на кнопку оформления заказа.(это в конструкторе или методом???) Метод render обновляет данные корзины (берет из модели данных (класса Cart) информцию о составе корзины. Тут слушаются события нажатия на кнопки удаления из корзины. отрисовывается общая цена товаров. блокируется кнопка дальнейшего оформления заказа, если общая цена корзины = 0.
  
- **OrderModal** . слушаются события нажатия на кнопки выбора способа оплаты, заполнения данных формы. рендер разблокирует кнопку далее в случае успешной валидации данных, введенных в адрес.(?)

- **ClientModal** слушает события ввода данных, блокируется/разблокируется кнопка.
  
- **SuccessModal**. есть ли рендер? ничего не меняется от действий пользователя (кроме нажатия на кнопку "за новыми покупками")???
  
- у всех компонентов метод render(), который отвечает за изменение отображения (блокировка кнопок, изменение текста кнпок и т.д.)
??
### Слой взаимодействия 
- **EventEmitter** в классической реализации содержит свойство events, хранящее зарегистрированные события. методами on/off (eventName, callback) устанавливается/снимается обработчик на событие. метод  emit(eventName, data?) регистрирует событие, onAll(callback)/offAll() слушиются все события/сбрасываются все обработчики.
- Класс **App** хранит текущее состояние приложения, управляет изменениями и с помощтю брокера событий уведомляет View/Model об изменениях.




Имеет свойство? *items: IProduct[]* ? и методы setItems(items: IProduct[]), getProduct(id: string), ?orderProduct?, ?getProductList? отвечающие за установку списка товаров в каталог и получение конкретного товара из списка.??

